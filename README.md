# æˆ¶æ”¿é–€ç‰Œè³‡æ–™çˆ¬èŸ²ç³»çµ±

è‡ªå‹•çˆ¬å–æˆ¶æ”¿é–€ç‰Œç·¨é‡˜è³‡æ–™çš„çˆ¬èŸ²ç³»çµ±ï¼Œæä¾› REST API ä»‹é¢åŠæ’ç¨‹åŠŸèƒ½ã€‚

---

## ç›®éŒ„

- [ç³»çµ±éœ€æ±‚](#ç³»çµ±éœ€æ±‚)
- [å¿«é€Ÿé–‹å§‹ï¼ˆDockerï¼‰](#å¿«é€Ÿé–‹å§‹docker)
- [æœ¬æ©ŸåŸ·è¡Œï¼ˆä¸ä½¿ç”¨ Dockerï¼‰](#æœ¬æ©ŸåŸ·è¡Œä¸ä½¿ç”¨-docker)
- [æœå‹™ç¶²å€èˆ‡ç™»å…¥è³‡è¨Š](#æœå‹™ç¶²å€èˆ‡ç™»å…¥è³‡è¨Š)
- [API ç«¯é»èªªæ˜](#api-ç«¯é»èªªæ˜)
- [ç’°å¢ƒè®Šæ•¸è¨­å®š](#ç’°å¢ƒè®Šæ•¸è¨­å®š)
- [å¸¸ç”¨æŒ‡ä»¤](#å¸¸ç”¨æŒ‡ä»¤)
- [å°ˆæ¡ˆçµæ§‹](#å°ˆæ¡ˆçµæ§‹)
- [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)

---

## ç³»çµ±éœ€æ±‚

### ä½¿ç”¨ Dockerï¼ˆæ¨è–¦ï¼‰

- **Docker** å’Œ **Docker Compose**
- ä¸éœ€è¦å®‰è£ Pythonï¼ˆå®¹å™¨å…§å·²åŒ…å«ï¼‰

| ä½œæ¥­ç³»çµ± | å®‰è£æ–¹å¼ |
|---------|---------|
| **Windows** | ä¸‹è¼‰ [Docker Desktop](https://www.docker.com/products/docker-desktop/) |
| **Mac** | ä¸‹è¼‰ [Docker Desktop](https://www.docker.com/products/docker-desktop/) |
| **Linux** | `sudo apt install docker.io docker-compose` |

### æœ¬æ©ŸåŸ·è¡Œï¼ˆä¸ä½¿ç”¨ Dockerï¼‰

- **Python 3.9+**
- **MySQL 8.0**ï¼ˆå¯é¸ï¼Œè‹¥ä¸éœ€è³‡æ–™åº«åŠŸèƒ½å¯è·³éï¼‰

---

## å¿«é€Ÿé–‹å§‹ï¼ˆDockerï¼‰

### Step 1: Clone å°ˆæ¡ˆ

```bash
git clone https://github.com/joeywangyolo/tw-address-crawler.git
cd tw-address-crawler
```

### Step 2: å•Ÿå‹•æ‰€æœ‰æœå‹™

```bash
docker-compose up -d
```

é¦–æ¬¡å•Ÿå‹•æœƒè‡ªå‹•ï¼š
- ä¸‹è¼‰ Pythonã€MySQLã€phpMyAdmin æ˜ åƒæª”
- å»ºç«‹è³‡æ–™åº«ä¸¦åŸ·è¡Œåˆå§‹åŒ– SQL
- å•Ÿå‹• API æœå‹™èˆ‡æ’ç¨‹å™¨

### Step 3: ç¢ºèªæœå‹™é‹ä½œ

```bash
docker-compose ps
```

æ‡‰é¡¯ç¤ºä¸‰å€‹æœå‹™éƒ½æ˜¯ `Up` ç‹€æ…‹ï¼š

```
NAME                  STATUS
household-api         Up
household-mysql       Up (healthy)
household-phpmyadmin  Up
```

### Step 4: æ¸¬è©¦ API

é–‹å•Ÿç€è¦½å™¨å‰å¾€ http://localhost:8000/docs å³å¯çœ‹åˆ° Swagger UI äº’å‹•å¼æ–‡ä»¶ã€‚

### Step 5: é€²å…¥å®¹å™¨æ‰‹å‹•åŸ·è¡Œçˆ¬èŸ²ï¼ˆå¯é¸ï¼‰

å¦‚æœæƒ³åœ¨ Docker å®¹å™¨å…§æ‰‹å‹•åŸ·è¡Œçˆ¬èŸ²ç¨‹å¼ï¼š

```bash
# é€²å…¥ API å®¹å™¨çš„ shell
docker exec -it household-api bash

# åŸ·è¡Œçˆ¬èŸ²ç¨‹å¼
python crawler_requests.py

# åŸ·è¡Œå®Œç•¢å¾Œé›¢é–‹å®¹å™¨
exit
```

æˆ–ç›´æ¥ä¸€è¡ŒæŒ‡ä»¤åŸ·è¡Œï¼ˆä¸é€²å…¥å®¹å™¨ï¼‰ï¼š

```bash
docker exec household-api python crawler_requests.py
```

> **PowerShell / CMD / Terminal çš†é©ç”¨**

---

## æœ¬æ©ŸåŸ·è¡Œï¼ˆä¸ä½¿ç”¨ Dockerï¼‰

å¦‚æœæƒ³åœ¨æœ¬æ©Ÿç›´æ¥åŸ·è¡Œ Python ç¨‹å¼ç¢¼ï¼Œè«‹æŒ‰ä»¥ä¸‹æ­¥é©Ÿæ“ä½œï¼š

### Step 1: å®‰è£ Python ä¾è³´

```bash
cd tw-address-crawler
pip install -r requirements.txt
```

### Step 2: åŸ·è¡Œçˆ¬èŸ²ç¨‹å¼ï¼ˆå–®æ¬¡åŸ·è¡Œï¼‰

```bash
python crawler_requests.py
```

é€™æœƒç›´æ¥åŸ·è¡Œä¸€æ¬¡çˆ¬èŸ²ï¼ŒæŸ¥è©¢æ‰€æœ‰å°åŒ—å¸‚è¡Œæ”¿å€çš„é–€ç‰Œè³‡æ–™ï¼Œçµæœæœƒï¼š
- è¼¸å‡ºåˆ°çµ‚ç«¯æ©Ÿ
- å„²å­˜ç‚º CSV æª”æ¡ˆæ–¼ `output/` è³‡æ–™å¤¾

### Step 3: å•Ÿå‹• API æœå‹™ï¼ˆå¯é¸ï¼‰

```bash
uvicorn api.main:app --reload --host 0.0.0.0 --port 8000
```

å•Ÿå‹•å¾Œå¯å‰å¾€ http://localhost:8000/docs ä½¿ç”¨ APIã€‚

> **æ³¨æ„**ï¼šæœ¬æ©ŸåŸ·è¡Œ API æ™‚ï¼Œè‹¥æœªå•Ÿå‹• MySQLï¼Œè³‡æ–™åº«ç›¸é—œåŠŸèƒ½æœƒè‡ªå‹•åœç”¨ï¼Œä½†çˆ¬èŸ²æ ¸å¿ƒåŠŸèƒ½ä»å¯æ­£å¸¸é‹ä½œã€‚

---

## æœå‹™ç¶²å€èˆ‡ç™»å…¥è³‡è¨Š

### æœå‹™åˆ—è¡¨

| æœå‹™ | ç¶²å€ | èªªæ˜ |
|-----|------|------|
| **API æ ¹ç›®éŒ„** | http://localhost:8000 | çˆ¬èŸ² API |
| **API æ–‡ä»¶ (Swagger)** | http://localhost:8000/docs | äº’å‹•å¼ API æ¸¬è©¦ä»‹é¢ |
| **API æ–‡ä»¶ (ReDoc)** | http://localhost:8000/redoc | éœæ…‹ API æ–‡ä»¶ |
| **phpMyAdmin** | http://localhost:8080 | MySQL è³‡æ–™åº«ç®¡ç†ä»‹é¢ |

### phpMyAdmin ç™»å…¥è³‡è¨Š

| é …ç›® | å€¼ |
|-----|-----|
| **ç¶²å€** | http://localhost:8080 |
| **å¸³è™Ÿ** | `root` |
| **å¯†ç¢¼** | `household123` |

> è‹¥æœ‰åœ¨ `.env` æª”æ¡ˆä¿®æ”¹ `MYSQL_PASSWORD`ï¼Œè«‹ä½¿ç”¨ä¿®æ”¹å¾Œçš„å¯†ç¢¼ç™»å…¥ã€‚

---

## API ç«¯é»èªªæ˜

æ‰€æœ‰ API ç«¯é»çš†ä»¥ `/api/v1` ç‚ºå‰ç¶´ã€‚

### ç³»çµ±ç›¸é—œ

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ |
|-----|------|------|
| `GET` | `/` | API æ ¹ç›®éŒ„ï¼Œé¡¯ç¤ºåŸºæœ¬è³‡è¨Šèˆ‡æ–‡ä»¶é€£çµ |
| `GET` | `/api/v1/health` | å¥åº·æª¢æŸ¥ï¼Œå›å‚³ API èˆ‡è³‡æ–™åº«é€£ç·šç‹€æ…‹ |

### æŸ¥è©¢ç›¸é—œ

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ |
|-----|------|------|
| `GET` | `/api/v1/districts` | å–å¾—æ‰€æœ‰æ”¯æ´çš„è¡Œæ”¿å€åˆ—è¡¨åŠä»£ç¢¼ |
| `POST` | `/api/v1/query/batch` | æ‰¹é‡æŸ¥è©¢å¤šå€‹è¡Œæ”¿å€çš„é–€ç‰Œè³‡æ–™ |

> ğŸ’¡ æ‰€æœ‰ POST è«‹æ±‚éœ€ä½¿ç”¨ `Content-Type: application/json`

#### `POST /api/v1/query/batch` æ‰¹é‡æŸ¥è©¢

**è«‹æ±‚åƒæ•¸ï¼š**

| æ¬„ä½ | é¡å‹ | å¿…å¡« | é è¨­å€¼ | èªªæ˜ |
|-----|------|:----:|-------|------|
| `start_date` | string | âœ… | - | èµ·å§‹æ—¥æœŸï¼Œ**æ°‘åœ‹å¹´æ ¼å¼**ï¼š`114-09-01` |
| `end_date` | string | âœ… | - | çµæŸæ—¥æœŸï¼Œ**æ°‘åœ‹å¹´æ ¼å¼**ï¼š`114-11-30` |
| `city_code` | string | âŒ | `"63000000"` | ç¸£å¸‚ä»£ç¢¼ï¼ˆç›®å‰åƒ…æ”¯æ´å°åŒ—å¸‚ï¼‰ |
| `register_kind` | string | âŒ | `"1"` | ç·¨é‡˜é¡åˆ¥ï¼š`1`=åˆç·¨, `2`=æ”¹ç·¨, `3`=å»¢æ­¢, `4`=å¾©ç”¨ |
| `districts` | array | âŒ | `null`ï¼ˆå…¨éƒ¨ï¼‰ | æŒ‡å®šè¡Œæ”¿å€åˆ—è¡¨ï¼Œ **ç›´æ¥ç§»é™¤è©²æ¬„ä½ï¼ˆä¸å‚³å…¥ï¼‰**è¡¨ç¤ºæŸ¥è©¢å…¨éƒ¨ 12 å€ |
| `save_to_db` | boolean | âŒ | `true` | æ˜¯å¦å°‡çµæœå­˜å…¥è³‡æ–™åº« |



**æ”¯æ´çš„è¡Œæ”¿å€ï¼š**

```
æ¾å±±å€ã€ä¿¡ç¾©å€ã€å¤§å®‰å€ã€ä¸­å±±å€ã€ä¸­æ­£å€ã€å¤§åŒå€ã€
è¬è¯å€ã€æ–‡å±±å€ã€å—æ¸¯å€ã€å…§æ¹–å€ã€å£«æ—å€ã€åŒ—æŠ•å€
```

**è«‹æ±‚ç¯„ä¾‹ï¼š**

```json
{
  "start_date": "114-09-01",
  "end_date": "114-11-30",
  "register_kind": "1",
  "districts": ["ä¸­æ­£å€", "å¤§å®‰å€"],
  "save_to_db": true
}
```

**å›æ‡‰ç¯„ä¾‹ï¼š**

```json
{
  "success": true,
  "total_count": 42,
  "district_results": {
    "ä¸­æ­£å€": 20,
    "å¤§å®‰å€": 22
  },
  "failed_districts": [],
  "execution_time": 15.32,
  "data": [...],
  "error_message": null
}
```

| å›æ‡‰æ¬„ä½ | èªªæ˜ |
|---------|------|
| `success` | æŸ¥è©¢æ˜¯å¦æˆåŠŸ |
| `total_count` | ç¸½è³‡æ–™ç­†æ•¸ |
| `district_results` | å„è¡Œæ”¿å€æŸ¥è©¢åˆ°çš„ç­†æ•¸ |
| `failed_districts` | æŸ¥è©¢å¤±æ•—çš„è¡Œæ”¿å€åˆ—è¡¨ |
| `execution_time` | åŸ·è¡Œæ™‚é–“ï¼ˆç§’ï¼‰ |
| `data` | é–€ç‰Œè³‡æ–™é™£åˆ—ï¼ˆè¶…é 300 ç­†æ™‚ä¸è¿”å›ï¼‰ |
| `error_message` | éŒ¯èª¤è¨Šæ¯ï¼ˆæˆåŠŸæ™‚ç‚º nullï¼‰ |

### æ’ç¨‹ç›¸é—œ

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ |
|-----|------|------|
| `GET` | `/api/v1/scheduler/status` | æŸ¥çœ‹æ’ç¨‹å™¨ç‹€æ…‹èˆ‡ä¸‹æ¬¡åŸ·è¡Œæ™‚é–“ |

### ä½¿ç”¨ç¯„ä¾‹

```bash
# å¥åº·æª¢æŸ¥
curl http://localhost:8000/api/v1/health

# å–å¾—è¡Œæ”¿å€åˆ—è¡¨
curl http://localhost:8000/api/v1/districts

# æŸ¥çœ‹æ’ç¨‹ç‹€æ…‹
curl http://localhost:8000/api/v1/scheduler/status

# æ‰¹é‡æŸ¥è©¢ï¼ˆä½¿ç”¨é è¨­åƒæ•¸ï¼‰
curl -X POST http://localhost:8000/api/v1/query/batch \
  -H "Content-Type: application/json" \
  -d '{"start_date": "114-09-01", "end_date": "114-11-30", "districts": ["ä¸­æ­£å€", "å¤§å®‰å€"]}'
```

---

## ç’°å¢ƒè®Šæ•¸è¨­å®š

æ‰€æœ‰è¨­å®šéƒ½åœ¨ `docker-compose.yml` ä¸­ç›´æ¥ä¿®æ”¹ï¼Œç„¡éœ€é¡å¤–è¨­å®šæª”æ¡ˆå³å¯å•Ÿå‹•ã€‚

### å¯è¨­å®šé …ç›®ï¼ˆç·¨è¼¯ `docker-compose.yml` ä¸­çš„ `api` æœå‹™ `environment` å€å¡Šï¼‰

| è®Šæ•¸ | é è¨­å€¼ | èªªæ˜ |
|-----|-------|------|
| `MYSQL_PASSWORD` | `household123` | MySQL root å¯†ç¢¼ |
| `ENABLE_SCHEDULER` | `true` | æ˜¯å¦å•Ÿç”¨è‡ªå‹•æ’ç¨‹ |
| `SCHEDULE_MODE` | `cron` | æ’ç¨‹æ¨¡å¼ï¼š`cron`ï¼ˆå›ºå®šæ™‚é–“ï¼‰æˆ– `interval`ï¼ˆé–“éš”åŸ·è¡Œï¼‰ |
| `SCHEDULE_HOUR` | `17` | Cron æ¨¡å¼ï¼šåŸ·è¡Œæ™‚é–“ï¼ˆå°æ™‚ï¼Œ0-23ï¼‰ |
| `SCHEDULE_MINUTE` | `17` | Cron æ¨¡å¼ï¼šåŸ·è¡Œæ™‚é–“ï¼ˆåˆ†é˜ï¼Œ0-59ï¼‰ |
| `SCHEDULE_INTERVAL_HOURS` | `1` | Interval æ¨¡å¼ï¼šé–“éš”å°æ™‚æ•¸ |
| `NOTIFICATION_ENABLED` | `false` | æ˜¯å¦å•Ÿç”¨ Email é€šçŸ¥ |
| `SMTP_USER` | - | å¯„ä»¶äºº Emailï¼ˆGmail éœ€ä½¿ç”¨æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼ï¼‰ |
| `SMTP_PASSWORD` | - | Email å¯†ç¢¼æˆ–æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼ |

---

## æ’ç¨‹åŠŸèƒ½èªªæ˜

ä½¿ç”¨ **APScheduler** å¯¦ç¾è‡ªå‹•æ’ç¨‹åŠŸèƒ½ï¼Œå¯åœ¨æŒ‡å®šæ™‚é–“è‡ªå‹•åŸ·è¡Œçˆ¬èŸ²ä»»å‹™ã€‚

### æ’ç¨‹æ¨¡å¼

| æ¨¡å¼ | èªªæ˜ | ç¯„ä¾‹ |
|-----|------|------|
| `cron` | å›ºå®šæ™‚é–“åŸ·è¡Œï¼ˆé è¨­ï¼‰ | æ¯å¤© 17:17 åŸ·è¡Œ |
| `interval` | é–“éš”åŸ·è¡Œ | æ¯ 1 å°æ™‚åŸ·è¡Œä¸€æ¬¡ |

### è¨­å®šæ–¹å¼

ç›´æ¥ç·¨è¼¯ `docker-compose.yml` ä¸­çš„ `api` æœå‹™ `environment` å€å¡Šï¼š

```yaml
# æ’ç¨‹è¨­å®šï¼ˆå¦‚éœ€ä¿®æ”¹è«‹ç›´æ¥ç·¨è¼¯æ­¤è™•ï¼‰
- ENABLE_SCHEDULER=true
- SCHEDULE_MODE=cron
- SCHEDULE_HOUR=17
- SCHEDULE_MINUTE=17
```

### æŸ¥çœ‹æ’ç¨‹ç‹€æ…‹

```bash
curl http://localhost:8000/api/v1/scheduler/status
```

å›æ‡‰ç¯„ä¾‹ï¼š

```json
{
  "enabled": true,
  "running": true,
  "schedule_time": "9:00",
  "jobs": [
    {
      "id": "cron_crawl",
      "name": "å®šæ™‚çˆ¬èŸ²ä»»å‹™",
      "next_run_time": "2025-01-22 09:00:00+08:00"
    }
  ]
}
```

---

## Email é€šçŸ¥åŠŸèƒ½

ç•¶çˆ¬èŸ²åŸ·è¡Œå¤±æ•—æˆ–æŸ¥è©¢çµæœç‚ºç©ºæ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•ç™¼é€ Email é€šçŸ¥ã€‚

### Step 1: å–å¾— Gmail æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼

Gmail ä¸å…è¨±ç›´æ¥ä½¿ç”¨å¸³è™Ÿå¯†ç¢¼ç™»å…¥ SMTPï¼Œéœ€è¦ä½¿ç”¨ã€Œæ‡‰ç”¨ç¨‹å¼å¯†ç¢¼ã€ã€‚

1. å‰å¾€ [Google æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼](https://myaccount.google.com/apppasswords)
2. ç™»å…¥ä½ çš„ Google å¸³è™Ÿ
3. é¸æ“‡æ‡‰ç”¨ç¨‹å¼ï¼šã€Œéƒµä»¶ã€
4. é¸æ“‡è£ç½®ï¼šã€ŒWindows é›»è…¦ã€æˆ–ã€Œå…¶ä»–ã€
5. é»æ“Šã€Œç”¢ç”Ÿã€ï¼Œè¤‡è£½ 16 ä½å¯†ç¢¼

> â„¹ï¸ å¿…é ˆå…ˆå•Ÿç”¨ã€Œå…©æ­¥é©—è­‰ã€æ‰èƒ½ä½¿ç”¨æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼

### Step 2: è¨­å®šç’°å¢ƒè®Šæ•¸

åœ¨ `.env` æˆ– `docker-compose.yml` ä¸­è¨­å®šï¼š

```yaml
# å•Ÿç”¨é€šçŸ¥
NOTIFICATION_ENABLED=true

# SMTP è¨­å®šï¼ˆGmailï¼‰
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=xxxx xxxx xxxx xxxx  # æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼ï¼ˆ16ä½ï¼‰
```

### Step 3: æ–°å¢æ”¶ä»¶äºº

é€é phpMyAdmin æˆ– SQL æ–°å¢æ”¶ä»¶äººï¼š

1. é–‹å•Ÿ http://localhost:8080 (phpMyAdmin)
2. é¸æ“‡è³‡æ–™åº« `household_db`
3. é»é¸ `email_address` è¡¨
4. æ–°å¢ä¸€ç­†è³‡æ–™ï¼š

```sql
INSERT INTO email_address (email, is_active) VALUES ('recipient@example.com', 1);
```

### Step 4: æ¸¬è©¦ç™¼ä¿¡åŠŸèƒ½

ä½¿ç”¨ä»¥ä¸‹æŸ¥è©¢æ¢ä»¶ï¼ˆå·²çŸ¥æŸ¥ç„¡è³‡æ–™ï¼‰ä¾†è§¸ç™¼ã€ŒæŸ¥è©¢è³‡æ–™ç‚ºç©ºã€é€šçŸ¥ï¼š

```bash
curl -X POST http://localhost:8000/api/v1/query/batch \
  -H "Content-Type: application/json" \
  -d '{
    "start_date": "114-09-01",
    "end_date": "114-11-30",
    "register_kind": "1",
    "districts": ["å—æ¸¯å€"]
  }'
```

> é€™å€‹æ¢ä»¶æŸ¥ç„¡è³‡æ–™ï¼Œæœƒè§¸ç™¼ç³»çµ±ç™¼é€ã€ŒæŸ¥è©¢è³‡æ–™ç‚ºç©ºã€Email é€šçŸ¥ã€‚

---

### æœ¬æ©ŸåŸ·è¡Œ

```bash
# å®‰è£å¥—ä»¶
pip install -r requirements.txt

# å–®æ¬¡åŸ·è¡Œçˆ¬èŸ²
python crawler_requests.py

# å•Ÿå‹• API æœå‹™
uvicorn api.main:app --reload --host 0.0.0.0 --port 8000
```

---

## å°ˆæ¡ˆçµæ§‹

```
tw-address-crawler/
â”œâ”€â”€ api/                    # FastAPI æ‡‰ç”¨ç¨‹å¼
â”‚   â”œâ”€â”€ main.py             # API ä¸»ç¨‹å¼èˆ‡è·¯ç”±å®šç¾©
â”‚   â””â”€â”€ schemas.py          # Pydantic è³‡æ–™æ¨¡å‹
â”œâ”€â”€ database/               # è³‡æ–™åº«ç›¸é—œ
â”‚   â”œâ”€â”€ db_manager.py       # è³‡æ–™åº«é€£ç·šèˆ‡æ“ä½œ
â”‚   â””â”€â”€ init.sql            # è³‡æ–™åº«åˆå§‹åŒ– SQL
â”œâ”€â”€ utils/                  # å·¥å…·æ¨¡çµ„
â”‚   â””â”€â”€ notifier.py         # Email é€šçŸ¥åŠŸèƒ½
â”œâ”€â”€ logs/                   # Log æª”æ¡ˆï¼ˆè‡ªå‹•ç”¢ç”Ÿï¼‰
â”œâ”€â”€ output/                 # CSV è¼¸å‡ºæª”æ¡ˆï¼ˆè‡ªå‹•ç”¢ç”Ÿï¼‰
â”œâ”€â”€ crawler_requests.py     # çˆ¬èŸ²æ ¸å¿ƒé‚è¼¯
â”œâ”€â”€ Dockerfile              # Docker æ˜ åƒæª”å®šç¾©
â”œâ”€â”€ docker-compose.yml      # Docker Compose æœå‹™ç·¨æ’
â”œâ”€â”€ requirements.txt        # Python ä¾è³´å¥—ä»¶
â”œâ”€â”€ .env.example            # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â””â”€â”€ README.md               # æœ¬æ–‡ä»¶
```

---

## å¸¸è¦‹å•é¡Œ

### Q: å•Ÿå‹•å¤±æ•—ï¼Œé¡¯ç¤º port å·²è¢«ä½¿ç”¨ï¼Ÿ

ä¿®æ”¹ `docker-compose.yml` ä¸­çš„ port æ˜ å°„ï¼š

```yaml
# API æœå‹™æ”¹ç”¨ 8001
ports:
  - "8001:8000"

# phpMyAdmin æ”¹ç”¨ 8081
ports:
  - "8081:80"
```


### Q: å¦‚ä½•æŸ¥çœ‹çˆ¬èŸ²åŸ·è¡Œçµæœï¼Ÿ

1. **æŸ¥çœ‹ CSV è¼¸å‡º**ï¼š`output/` è³‡æ–™å¤¾
2. **æŸ¥çœ‹è³‡æ–™åº«**ï¼šhttp://localhost:8080 (phpMyAdmin)
3. **æŸ¥çœ‹ Log**ï¼š`docker-compose logs -f api`
4. **æ¯æ¬¡åŸ·è¡Œçš„Log æœƒè¨˜éŒ„æ–¼**: è³‡æ–™åº«çš„ `crawler_logs` è¡¨æ ¼ä¸­

### Q: é©—è­‰ç¢¼è­˜åˆ¥å¤±æ•—æ€éº¼è¾¦ï¼Ÿ

ç³»çµ±ä½¿ç”¨ `ddddocr` è‡ªå‹•è­˜åˆ¥é©—è­‰ç¢¼ï¼Œè­˜åˆ¥ç‡ç´„ 90%ã€‚å¤±æ•—æ™‚æœƒè‡ªå‹•é‡è©¦ï¼ˆæœ€å¤š 10 æ¬¡ï¼‰ã€‚è‹¥é€£çºŒå¤±æ•—ï¼Œæœƒåœ¨ Log ä¸­é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ã€‚

### Q: å¦‚ä½•ä¿®æ”¹çˆ¬èŸ²çš„æŸ¥è©¢æ—¥æœŸç¯„åœï¼Ÿ

1. **é€é API**ï¼šå‘¼å« `/api/v1/query/batch` æ™‚æŒ‡å®š `start_date` å’Œ `end_date`
2. **ä¿®æ”¹é è¨­å€¼**ï¼šç·¨è¼¯ `crawler_requests.py` ä¸­çš„ `main()` å‡½æ•¸

### Q: æ’ç¨‹å™¨æ²’æœ‰è‡ªå‹•åŸ·è¡Œï¼Ÿ

1. ç¢ºèª `ENABLE_SCHEDULER=true`
2. æª¢æŸ¥æ’ç¨‹ç‹€æ…‹ï¼š`curl http://localhost:8000/api/v1/scheduler/status`
3. æŸ¥çœ‹ Log ç¢ºèªæ˜¯å¦æœ‰éŒ¯èª¤è¨Šæ¯
